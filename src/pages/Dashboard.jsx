import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { useAuth } from "../app/provider/AuthProvider";
import personService from "../shared/services/personService";
import districtService from "../shared/services/districtService";
import "./Dashboard.css";

export default function Dashboard() {
  const { user } = useAuth();
  const navigate = useNavigate();

  const [allPersons, setAllPersons] = useState([]);
  const [selectedDistrict, setSelectedDistrict] = useState(null);
  const [districtStats, setDistrictStats] = useState({});
  const [overallStats, setOverallStats] = useState({ total: 0, inProcess: 0 });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    try {
      setLoading(true);

      // Barcha shaxslarni yuklash
      const personsResponse = await personService.getAll(user);
      setAllPersons(personsResponse.data);

      // Umumiy statistika
      const statsResponse = await personService.getOverallStats();
      setOverallStats(statsResponse.data);

      // Har bir tuman uchun statistika
      const districts = await districtService.getAll();
      const stats = {};

      for (const district of districts.data) {
        const districtPersons = personsResponse.data.filter(p => p.districtId === district.id);
        stats[district.id] = {
          total: districtPersons.length,
          inProcess: districtPersons.filter(p => p.inProcess).length,
          name: district.name
        };
      }

      setDistrictStats(stats);

    } catch (err) {
      console.error("Ma'lumotlarni yuklashda xatolik:", err);
    } finally {
      setLoading(false);
    }
  };

  const handleDistrictClick = (districtId) => {
    setSelectedDistrict(selectedDistrict === districtId ? null : districtId);
  };

  const filteredPersons = selectedDistrict
    ? allPersons.filter(p => p.districtId === selectedDistrict)
    : [];

  if (loading) {
    return (
      <div className="dashboard">
        <div className="loading">Yuklanmoqda...</div>
      </div>
    );
  }

  return (
    <div className="dashboard">
      {/* Xarita - faqat Super Admin uchun */}
      {user.role === "SUPER_ADMIN" && (
        <div className="dashboard__map">
          <svg viewBox="-100 -80 1000 600" className="namangan-map">
            {/* Pop tumani */}
            <g onClick={() => handleDistrictClick(1)} className="district" data-selected={selectedDistrict === 1}>
             <path d="M122.244 46.8433C123.018 46.5339 123.87 46.4741 124.68 46.6724L141.287 50.7397C142.496 51.0358 143.498 51.8777 143.998 53.0171L146.521 58.7612C146.888 59.5979 147.441 60.34 148.139 60.9302L169.413 78.9282C169.966 79.3957 170.38 80.005 170.614 80.6899L174.259 91.3608C174.545 92.1988 174.545 93.1088 174.259 93.9468L170.299 105.543C170.221 105.773 170.156 106.007 170.106 106.245L170.061 106.483L166.942 124.953C166.838 125.564 166.831 126.188 166.919 126.802L169.997 148.306C170.098 149.01 170.323 149.691 170.662 150.316L171.009 150.956C173.139 154.883 178.66 155.188 181.21 151.52L188.271 141.362C188.743 140.682 189.416 140.165 190.195 139.883L199.516 136.513C201.024 135.968 202.713 136.377 203.806 137.551L216.73 151.453C217.316 152.084 218.032 152.581 218.828 152.911L231.356 158.098C231.912 158.328 232.409 158.682 232.81 159.131L243.552 171.17C245.286 173.114 248.076 173.716 250.458 172.662L270.971 163.577L282.2 159.088V175.244H275.861C273.9 175.244 272.062 176.203 270.94 177.812L261.877 190.808C261.178 191.811 260.059 192.439 258.839 192.513L246.752 193.248C245.155 193.345 243.663 194.075 242.608 195.277L240.899 197.223C239.286 199.059 238.948 201.69 240.044 203.874L242.748 209.262C243.575 210.91 245.113 212.086 246.92 212.452L252.157 213.512C253.334 213.751 254.342 214.505 254.902 215.568L259.134 223.599C259.778 224.822 259.745 226.292 259.047 227.485L258.927 227.691C258.065 229.163 257.871 230.933 258.393 232.557L264.083 250.272C264.288 250.91 264.599 251.51 265.002 252.045L270.247 259.014C271.823 261.108 274.575 261.936 277.045 261.061L281.568 259.458C282.575 259.102 283.683 259.163 284.645 259.627L290.062 262.245L290.077 262.252L290.093 262.259L309.408 270.774C310.045 271.055 310.587 271.513 310.97 272.094C312.689 274.705 316.21 275.41 318.802 273.661L326.277 268.616C326.592 268.403 326.935 268.237 327.297 268.122L350.544 260.69C351.212 260.476 351.924 260.443 352.609 260.591L357.487 261.649C359.001 261.977 360.189 263.15 360.537 264.66L363.908 279.284C364.331 281.118 365.589 282.647 367.308 283.415L375.157 286.92C376.065 287.326 377.058 287.499 378.049 287.425L407.539 285.23C409.048 285.118 410.492 285.866 411.269 287.165L411.526 287.596C412.256 288.815 412.285 290.33 411.602 291.576L411.089 292.51C410.387 293.79 409.042 294.585 407.582 294.585H401.757C400.341 294.585 398.97 295.086 397.888 296L394.348 298.987C393.807 299.443 393.156 299.748 392.459 299.87L376.972 302.583C376.744 302.622 376.513 302.643 376.282 302.643H367.35C365.875 302.643 364.452 303.185 363.353 304.167L355.312 311.35C354.397 312.167 353.157 312.519 351.949 312.305L336.415 309.553C334.897 309.284 333.333 309.61 332.049 310.463L330.644 311.397C328.97 312.509 327.964 314.385 327.964 316.395V318.286C327.964 319.054 327.743 319.806 327.327 320.452L314.521 340.34C314.01 341.133 313.235 341.72 312.334 341.998L269.257 355.256C267.316 355.854 265.235 354.901 264.418 353.042L262.924 349.638C262.384 348.409 261.448 347.395 260.265 346.761L251.945 342.303C250.827 341.704 249.548 341.475 248.291 341.648L237.156 343.185C235.729 343.382 234.419 344.087 233.468 345.17L227.857 351.56C227.276 352.221 226.494 352.673 225.631 352.844L199.439 358.052L199.427 358.055L199.415 358.057L188.831 360.421C188.267 360.547 187.728 360.764 187.234 361.064C184.671 362.621 181.527 360.23 182.342 357.344L182.409 357.106C183.088 354.702 182.028 352.147 179.849 350.927L170.276 345.572L170.225 345.543L170.17 345.521L156.973 340.055C155.882 339.604 154.682 339.483 153.524 339.71L136.23 343.099C135.307 343.28 134.35 343.13 133.527 342.675L130.407 340.953C129.133 340.249 128.341 338.908 128.341 337.452V330.393C128.341 330.093 128.374 329.792 128.442 329.5L130.637 319.916L144.186 329.378C145.603 330.368 147.44 330.527 149.006 329.795C152.537 328.146 152.769 323.213 149.409 321.238L135.144 312.851L135.109 312.831L135.071 312.813L128.629 309.701C128.178 309.483 127.772 309.182 127.432 308.814L101.559 280.821L81.4376 255.996C80.6031 254.966 79.4508 254.241 78.1613 253.935L71.0089 252.238C70.0789 252.017 69.2583 251.471 68.6964 250.698L59.547 238.106C59.324 237.799 59.0723 237.514 58.796 237.255L58.5118 237.005L46.5851 227.163C45.2346 226.048 44.7653 224.185 45.4279 222.564L49.1281 213.513C49.573 212.425 50.4745 211.586 51.5929 211.222L54.8605 210.16C57.4074 209.331 58.4674 206.305 56.9943 204.068C56.6053 203.477 56.0685 202.999 55.4376 202.679L28.2618 188.924C27.4058 188.491 26.8663 187.612 26.8663 186.653V186.056C26.8663 185.394 27.2625 184.797 27.8722 184.54C30.4968 183.433 30.8948 179.878 28.5802 178.218L21.3888 173.062C20.9098 172.719 20.5126 172.273 20.2257 171.758L15.1505 162.651C14.3433 161.202 14.5141 159.405 15.5792 158.134L22.0363 150.43C22.5252 149.847 22.8987 149.176 23.1368 148.453L25.1984 142.193C26.2597 138.97 24.4383 135.507 21.1808 134.556L18.5704 133.794C17.7435 133.553 16.8741 133.492 16.0216 133.617L6.78723 134.965C4.07028 135.362 1.77072 132.965 2.27844 130.267L4.41223 118.925C4.68337 117.484 5.72163 116.306 7.11731 115.857L25.3615 109.981C26.0059 109.773 26.6103 109.458 27.1495 109.048L42.4259 97.4507C43.4317 96.687 44.1709 95.6248 44.5382 94.4165L49.2999 78.7495C49.6702 77.5313 50.5989 76.5617 51.7999 76.1392L75.797 67.6958C76.4376 67.4704 77.0352 67.1379 77.5646 66.7124L88.173 58.1841L88.1827 58.1772L88.1915 58.1694L93.0109 54.104C93.6108 53.5979 94.3465 53.2791 95.1261 53.188L110.217 51.4253C110.742 51.364 111.256 51.2337 111.747 51.0376L122.244 46.8433Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="175" y="250" textAnchor="middle" fontSize="14" fontWeight="bold" fill="black">–ü–û–ü</text>
            </g>

            {/* Chust tumani */}
            <g onClick={() => handleDistrictClick(2)} className="district" data-selected={selectedDistrict === 2}>
<path d="M346.477 156.343C348.487 154.986 351.018 154.653 353.31 155.444L355.137 156.075C355.911 156.342 356.625 156.757 357.241 157.295L365.037 164.101C367.397 166.16 371.084 164.485 371.084 161.353C371.085 160.311 372.038 159.532 373.059 159.738L378.615 160.863C379.311 161.004 379.978 161.262 380.588 161.626L383.374 163.288C386.44 165.117 388.317 168.423 388.318 171.992V174.378C388.318 177.13 389.75 179.682 392.098 181.116L392.899 181.657C396.281 183.94 400.809 183.49 403.676 180.587C404.863 179.385 405.665 177.856 405.978 176.195L406.142 175.323C406.572 173.037 407.836 170.993 409.689 169.586L410.364 169.073C411.246 168.403 412.22 167.864 413.256 167.471L416.53 166.228C418.283 165.562 420.199 165.452 422.017 165.912C423.706 166.34 425.239 167.241 426.433 168.511L428.39 170.591C430.05 172.355 431.356 174.423 432.237 176.68L435.414 184.822C435.95 186.194 436.816 187.413 437.936 188.369C439.961 190.099 440.818 192.837 440.139 195.413L439.065 199.49C438.936 199.98 438.615 200.398 438.175 200.648C436.862 201.396 436.101 202.838 436.225 204.345L436.48 207.438C436.666 209.704 437.726 211.808 439.436 213.306L441.142 214.8C443.82 217.146 445.356 220.534 445.356 224.095V243.729C445.356 245.958 446.897 247.89 449.07 248.385C450.568 248.726 451.503 250.221 451.156 251.718L450.74 253.506C450.375 255.076 449.215 256.341 447.682 256.84L446.879 257.101C446.404 257.255 445.911 257.351 445.412 257.386L438.133 257.888C433.74 258.191 429.59 260.016 426.396 263.047L426.307 263.131C424.093 265.232 422.435 267.848 421.481 270.747C419.928 275.463 416.329 279.226 411.688 280.988L408.931 282.035C407.198 282.693 405.391 283.135 403.55 283.353L381.966 285.901C378.71 286.286 375.418 285.57 372.615 283.868L371.542 283.216C370.835 282.786 370.067 282.465 369.264 282.262C366.716 281.617 364.832 279.462 364.532 276.851L363.906 271.386C363.818 270.611 363.673 269.845 363.475 269.091L362.35 264.819C361.91 263.148 360.853 261.706 359.393 260.782C357.863 259.815 356.012 259.492 354.245 259.887L347.239 261.452C345.912 261.748 344.611 262.155 343.353 262.67L336.588 265.436L324.016 269.455L323.99 269.464L323.966 269.473L321.042 270.583C320.188 270.907 319.433 271.45 318.852 272.155C317.742 273.504 315.764 273.735 314.373 272.679L314.115 272.481C313.874 272.298 313.657 272.086 313.469 271.849L313.162 271.461C312.192 270.233 310.934 269.264 309.498 268.642L287.406 259.058C284.898 257.969 282.103 257.75 279.463 258.425L278.937 258.572L278.177 258.803V258.804C277.084 259.136 275.926 259.197 274.804 258.984C272.925 258.628 271.271 257.524 270.219 255.927L267.086 251.171C266.06 249.613 265.252 247.922 264.683 246.146L260.432 232.877C259.964 231.418 259.97 229.847 260.449 228.392C261.27 225.898 260.994 223.173 259.69 220.895L257.466 217.011C255.683 213.897 252.671 211.678 249.169 210.896L248.461 210.737C245.358 210.044 242.813 207.834 241.694 204.858L241.502 204.348C241.23 203.624 241.09 202.858 241.09 202.085C241.09 200.076 242.029 198.182 243.629 196.968L244.128 196.589C245.213 195.765 246.498 195.245 247.85 195.081L251.631 194.621C258.562 193.779 264.771 189.932 268.611 184.102L271.014 180.453C271.646 179.494 272.483 178.686 273.465 178.09L273.637 177.985C274.476 177.475 275.416 177.152 276.392 177.038C280.844 176.518 284.2 172.747 284.2 168.265V159.841C288.231 163.343 292.901 166.037 297.958 167.765L301.181 168.865C302.587 169.346 303.918 170.024 305.133 170.881C309.987 174.303 316.238 175.051 321.762 172.87L327.375 170.654C329.317 169.888 330.779 168.242 331.311 166.223C331.905 163.969 334.102 162.526 336.406 162.876L337.251 163.004C340.143 163.443 342.941 161.775 343.93 159.022C344.226 158.199 344.777 157.491 345.502 157.001L346.477 156.343Z" fill="#38D9A0" stroke="white" stroke-width="2"/>
             
              <text x="325" y="215" textAnchor="middle" fontSize="14" fontWeight="bold" fill="black">–ß–£–°–¢</text>
            </g>

            {/* Yangiqo'rg'on */}
            <g onClick={() => handleDistrictClick(3)} className="district" data-selected={selectedDistrict === 3}>
             <path d="M512.423 107.523C514.715 106.446 517.355 106.384 519.694 107.353L521.982 108.3C522.715 108.604 523.501 108.76 524.294 108.76C526.281 108.76 527.974 110.204 528.287 112.167L529.729 121.19C530.11 123.576 531.266 125.771 533.019 127.434L536.55 130.786C537.609 131.791 538.208 133.188 538.208 134.648C538.208 136.728 539.093 138.71 540.641 140.099L545.015 144.023C545.506 144.464 545.948 144.957 546.331 145.495L553.554 155.619C554.007 156.254 554.376 156.946 554.651 157.676L555.72 160.518C556.377 162.266 556.475 164.174 555.999 165.98L554.359 172.211C554.239 172.664 554.084 173.108 553.896 173.537L551.558 178.863L551.531 178.922L551.514 178.984L549.985 184.206C549.444 186.057 547.745 187.329 545.817 187.329C542.668 187.329 539.996 189.638 539.54 192.754L536.617 212.725C536.389 214.288 535.753 215.763 534.774 217.003L533.13 219.082C532.636 219.706 532.212 220.383 531.864 221.099L530.369 224.181C529.04 226.921 525.926 228.302 523.002 227.448C520.993 226.861 518.837 227.062 516.97 228.006L516.887 228.047C514.19 229.413 510.907 228.731 508.978 226.404L502.652 218.777C501.822 217.775 500.82 216.929 499.693 216.277L492.307 212.005C489.526 210.396 487.813 207.426 487.813 204.214V195.221C487.813 192.495 485.875 190.154 483.196 189.646C482.429 189.5 481.727 189.114 481.194 188.543L472.342 179.053C471.198 177.827 469.208 177.995 468.285 179.396C468.056 179.745 467.913 180.144 467.871 180.559L466.239 196.668C466.053 198.504 465.299 200.237 464.081 201.624C462.718 203.177 461.825 205.086 461.509 207.129L459.303 221.366L458.302 225.926C458.11 226.801 457.789 227.641 457.349 228.421L454.799 232.936L453.095 230.996C452.014 229.765 450.299 229.304 448.747 229.828C447.412 230.278 446.029 229.285 446.029 227.877V222.607C446.029 221.074 445.58 219.574 444.736 218.294L443.212 215.978L443.194 215.952L443.176 215.926L440.523 212.401L440.51 212.384L440.495 212.367L439.33 210.952C438.087 209.441 437.407 207.546 437.407 205.589V203.664C437.407 202.516 437.891 201.423 438.739 200.65L438.995 200.417C440.096 199.413 440.724 197.992 440.724 196.503V195.238C440.724 195.005 440.832 194.785 441.018 194.644C442.168 193.771 442.445 192.155 441.651 190.948L441.532 190.768C441.259 190.353 441.342 189.797 441.725 189.48L446.911 185.184C447.355 184.817 447.835 184.495 448.343 184.225L460.476 177.778C460.766 177.624 461.025 177.418 461.242 177.171C462.224 176.053 462.124 174.354 461.02 173.358L454.793 167.744C453.014 166.14 451.998 163.857 451.998 161.462C451.998 160.088 452.333 158.735 452.974 157.519L455.037 153.603C455.505 152.715 456.179 151.952 457.003 151.379C460.983 148.609 461.738 143.026 458.637 139.298L457.254 137.635C456.372 136.575 455.77 135.309 455.502 133.956L454.497 128.873C454.231 127.525 454.65 126.132 455.615 125.155C457.143 123.609 457.74 121.371 457.187 119.269L457.036 118.698C456.486 116.609 457.289 114.398 459.051 113.149L461.18 111.641C463.611 109.918 466.741 109.519 469.527 110.577L469.877 110.71L469.917 110.724L469.958 110.736L472.194 111.373C474.391 111.998 476.727 111.924 478.88 111.162L484.541 109.156C485.281 108.894 486.06 108.76 486.845 108.76H489.432C490.321 108.76 491.143 109.239 491.58 110.014C492.372 111.417 493.858 112.285 495.469 112.285H499.834C501.452 112.285 503.05 111.928 504.514 111.24L512.423 107.523Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="200" y="425" textAnchor="middle" fontSize="12" fontWeight="bold" fill="black">–Ø–ù–ì–ò“ö–é–†“í–û–ù</text>
            </g>

            {/* Kosonsoy */}
            <g onClick={() => handleDistrictClick(4)} className="district" data-selected={selectedDistrict === 4}>
            <path d="M571.916 3.27148C573.224 1.92333 575.141 1.35444 576.972 1.77148L578.451 2.1084C579.183 2.27528 579.794 2.77975 580.096 3.46777C580.609 4.63636 580.105 6.00143 578.956 6.55664L575.65 8.1543C574.72 8.60387 574.022 9.42619 573.732 10.418L573.691 10.5576C573.027 12.8276 574.729 15.0994 577.094 15.0996C577.781 15.0996 578.386 15.5521 578.579 16.2109L578.712 16.666C578.98 17.5817 578.62 18.5658 577.826 19.0938L574.469 21.3232L574.427 21.3516L574.387 21.3838L569.856 25.1113C567.479 27.0664 566.648 30.3392 567.804 33.1914C568.329 34.4863 568.293 35.941 567.704 37.208L565.236 42.5156C564.993 43.0375 564.701 43.5349 564.364 44.001L559.068 51.3115C557.983 52.8088 557.627 54.7141 558.098 56.502C558.623 58.4923 560.106 60.0902 562.051 60.7617L565.942 62.1045C566.635 62.3438 567.381 62.3878 568.098 62.2324C570.669 61.6748 572.014 58.8325 570.815 56.4912L569.773 54.458C568.942 52.8347 569.395 50.8489 570.847 49.7461L571.206 49.4736C571.794 49.0272 572.487 48.7397 573.218 48.6387L574.438 48.4697C576.97 48.1203 579.489 49.1886 580.998 51.251C581.296 51.659 581.549 52.0986 581.753 52.5615L583.535 56.6191C584.414 58.622 586.394 59.916 588.582 59.916C590.005 59.916 591.288 60.7746 591.83 62.0908L596.012 72.2529C596.714 73.9574 596.586 75.8912 595.666 77.4883C593.726 80.8543 594.503 85.1289 597.504 87.5967L599.297 89.0713C600.475 90.0405 601.847 90.7467 603.321 91.1416L607.031 92.1357C610.118 92.9631 612.535 95.3653 613.38 98.4473L614.891 103.953C615.102 104.721 615.395 105.464 615.766 106.169L620.738 115.606C621.419 116.9 621.776 118.339 621.776 119.801V124.138C621.776 125.964 620.618 127.59 618.891 128.186L613.812 129.938C610.682 131.019 610.285 135.285 613.163 136.924C614.053 137.431 614.362 138.565 613.852 139.453L604.735 155.332C604.2 156.265 603.804 157.271 603.56 158.318L602.319 163.662C602.12 164.516 601.565 165.243 600.795 165.661C599.475 166.377 597.831 166.031 596.912 164.845L595.452 162.96C593.422 160.341 589.662 159.845 587.023 161.849C585.519 162.991 584.635 164.771 584.634 166.66V184.249C584.635 188.018 587.049 191.363 590.626 192.551L592.126 193.049C593.989 193.668 595.247 195.411 595.247 197.374C595.247 199.891 593.206 201.932 590.689 201.932H578.908C575.732 201.932 572.77 203.529 571.023 206.181C570.42 207.096 569.981 208.109 569.726 209.175L568.251 215.338C567.766 217.36 566.596 219.153 564.94 220.41L553.159 229.354L541.318 219.673C538.675 217.512 537.483 214.041 538.239 210.712L540.003 202.945C540.135 202.36 540.22 201.766 540.255 201.167L540.737 193.134C540.804 192.011 541.358 190.974 542.254 190.294C542.711 189.947 543.241 189.705 543.803 189.589L544.59 189.426C548.281 188.662 551.16 185.744 551.907 182.058C552.035 181.426 552.246 180.809 552.531 180.232L555.222 174.783C555.805 173.604 556.171 172.329 556.303 171.021L557.152 162.642C557.364 160.549 556.972 158.438 556.021 156.562L554.626 153.808C554.19 152.947 553.642 152.147 552.998 151.429L543.932 141.334L543.899 141.299L541.952 139.327C540.791 138.152 540.054 136.624 539.858 134.984C539.626 133.043 538.795 131.22 537.482 129.771L533.967 125.889C532.806 124.606 532.039 123.016 531.758 121.31L531.573 120.187L531.572 120.18L530.392 113.315C529.838 110.089 527.174 107.644 523.912 107.369C523.247 107.313 522.6 107.129 522.005 106.828L521.671 106.658C519.803 105.713 517.666 105.439 515.621 105.883L514.189 106.193L519.586 102.528C521.678 101.107 523.217 99.0074 523.942 96.584L525.725 90.627C525.953 89.8676 526.538 89.2678 527.292 89.0225C528.472 88.6383 529.752 89.212 530.251 90.3486L531.91 94.127C532.302 95.019 533.108 95.6611 534.065 95.8428C535.493 96.1138 536.907 95.3056 537.398 93.9375L538.823 89.9707L538.827 89.96L542.143 80.3926L542.166 80.3281L542.178 80.2607L544.962 66.3154C545.218 65.0317 546.16 63.9927 547.413 63.6123C550.184 62.7704 551.842 59.9394 551.221 57.1104L551.03 56.2383C550.848 55.4106 550.507 54.6258 550.025 53.9287L539.899 39.2842C537.76 36.1912 533.831 34.8885 530.268 36.0908C529.886 36.22 529.492 36.3129 529.091 36.3682L525.755 36.8291C524.05 37.0645 522.341 36.4273 521.205 35.1338L520.936 34.8281C520.849 34.7284 520.773 34.6183 520.712 34.501C520.296 33.7121 520.566 32.7363 521.328 32.2734L522.027 31.8486C522.244 31.7166 522.481 31.6181 522.727 31.5557L528.853 30.0049C529.813 29.7618 530.737 29.3905 531.597 28.9004L537.198 25.7109C537.902 25.31 538.657 25.0055 539.443 24.8066L542.835 23.9482C545.155 23.3609 547.221 22.0327 548.718 20.165L553.309 14.4395C554.805 12.5733 556.983 11.379 559.361 11.1211L560.933 10.9502C563.482 10.6737 565.855 9.51587 567.641 7.67578L571.916 3.27148Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="475" y="250" textAnchor="middle" fontSize="12" fontWeight="bold" fill="black">–ö–û–°–û–ù–°–û–ô</text>
            </g>

            {/* Chortoq */}
            <g onClick={() => handleDistrictClick(5)} className="district" data-selected={selectedDistrict === 5}>
              <path d="M598.021 42.2913C599.786 42.2914 601.217 43.722 601.217 45.4866V50.928L601.226 50.9963L601.692 54.3645C602.271 58.5357 605.18 62.0106 609.185 63.3137L610.912 63.8752C611.869 64.1868 612.768 64.6571 613.569 65.2659L616.229 67.2854C618.471 68.9871 619.787 71.6393 619.787 74.4534V77.9866C619.787 80.2503 620.946 82.3563 622.859 83.5667C623.916 84.2349 625.14 84.59 626.39 84.5901H628.29C631.397 84.59 634.358 83.2757 636.443 80.9729L639.04 78.1057C639.947 77.1044 641.235 76.5325 642.586 76.5325H643.663C645.035 76.5325 646.259 77.3941 646.723 78.6848C647.174 79.942 646.81 81.3474 645.806 82.2278L640.667 86.7297C639.678 87.596 638.94 88.7116 638.528 89.9602C637.53 92.9917 638.601 96.3215 641.181 98.2014L649.913 104.566C652.237 106.26 653.611 108.963 653.611 111.839V116.394C653.611 117.943 654.395 119.387 655.693 120.232L656.16 120.536C657.101 121.148 657.364 122.409 656.747 123.346C656.607 123.559 656.427 123.743 656.218 123.89L649.957 128.279C648.591 129.236 647.46 130.492 646.65 131.951L642.466 139.495L640.66 142.408C638.339 146.153 638.476 150.922 641.009 154.527L642.519 156.676L642.538 156.704L642.56 156.731L645.401 160.237C647.144 162.387 649.634 163.801 652.373 164.198L659.364 165.208C661.005 165.446 662.451 166.409 663.303 167.831C664.219 169.362 664.337 171.242 663.62 172.876L663.019 174.245C662.615 175.164 662.018 175.985 661.267 176.651C659.351 178.347 658.255 180.783 658.255 183.342V189.115C658.255 190.518 658.911 191.842 660.029 192.691C661.073 193.483 661.324 194.95 660.604 196.044L660.496 196.206C660.143 196.743 659.609 197.136 658.992 197.315L649.115 200.171C647.145 200.741 645.373 201.851 644 203.374L638.339 209.657C637.712 210.353 636.981 210.945 636.172 211.415L628.582 215.822C627.209 216.618 625.651 217.038 624.063 217.038H607.84C607.253 217.038 606.667 216.981 606.091 216.866L593.468 214.366C592.253 214.126 591.006 214.092 589.78 214.267L580.92 215.528H576.812C576.139 215.528 575.468 215.452 574.812 215.303L570.255 214.265L571.301 209.77C571.712 208.002 572.728 206.434 574.173 205.337C575.397 204.408 576.869 203.862 578.403 203.769L590.152 203.055C591.799 202.955 593.351 202.25 594.511 201.076L595.165 200.415C596.53 199.034 597.006 197.004 596.398 195.159C595.978 193.884 595.079 192.821 593.891 192.197L589.452 189.864C587.958 189.078 586.827 187.743 586.299 186.139C586.083 185.482 585.973 184.794 585.973 184.103V166.687C585.973 166.154 586.083 165.627 586.297 165.139C586.758 164.088 587.664 163.299 588.768 162.985L589.146 162.876C590.564 162.473 592.089 162.76 593.263 163.652L596.949 166.45C598.05 167.286 599.485 167.543 600.808 167.142C602.19 166.722 603.269 165.638 603.684 164.254L606.156 155.993C606.356 155.326 606.633 154.684 606.98 154.08L614.407 141.194C615.388 139.492 615.051 137.337 613.6 136.015C612.999 135.468 612.753 134.632 612.96 133.847L613.208 132.903C613.502 131.788 614.286 130.868 615.34 130.402L617.426 129.478C620.084 128.301 622.079 126 622.868 123.202C623.495 120.983 623.315 118.613 622.361 116.513L617.07 104.864L614.039 96.9739C612.916 94.0515 610.602 91.7461 607.675 90.635L603.956 89.2229L600.854 87.5745C598.898 86.5348 597.483 84.7053 596.967 82.551C596.727 81.5506 596.689 80.5124 596.856 79.4973L597.473 75.759C597.779 73.8976 597.601 71.9882 596.957 70.2151L592.567 58.1321L591.316 52.1926C590.581 48.7004 592.185 45.1326 595.286 43.3665L596.44 42.7102C596.922 42.4359 597.467 42.2913 598.021 42.2913Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="600" y="250" textAnchor="middle" fontSize="12" fontWeight="bold" fill="black">–ß–û–†–¢–û“ö</text>
            </g>

            {/* Uychi */}
            <g onClick={() => handleDistrictClick(6)} className="district" data-selected={selectedDistrict === 6}>
            <path d="M585.972 224.375L585.888 224.182L582.465 216.386L591.583 215.519L614.022 218.526L614.088 218.535H624.915L625.057 218.492L631.689 216.477L631.861 216.426L632.004 216.317L637.309 212.289L637.344 212.262L637.378 212.231L640.694 209.21L640.719 209.187L640.743 209.163L645.96 203.716L649.067 201.829L659.57 198.342L659.991 198.202L660.17 197.795L661.497 194.773L661.673 194.371L661.497 193.97L659.592 189.631V181.626L663.355 176.863L663.425 176.776L663.472 176.676L666.126 171.137L666.404 170.556L665.99 170.062L661.347 164.523L661.152 164.291L660.861 164.205L657.309 163.168L679.691 161.144L686.66 163.55L703.135 174.557L703.185 174.591L703.239 174.618L717.168 181.668L717.381 181.775H725.394L718.186 190.196L718.145 190.244L718.11 190.297L712.897 198.211L705.739 203.646L688.495 216.738L688.415 216.8L688.348 216.875L679.063 227.45L679.055 227.458L679.049 227.467L674.521 232.868L658.839 241.798L651.633 244.285L651.366 244.377L651.187 244.595L648.113 248.327L641.86 249.277L641.01 249.406V254.805H635.105L634.87 254.944L629.093 258.354L618.703 259.342L618.371 259.373L618.124 259.598L611.685 265.462L606.115 266.731L605.122 264.467L604.859 263.869H598.655L593.002 258.146L585.972 249.897V224.375Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="700" y="200" textAnchor="middle" fontSize="14" fontWeight="bold" fill="black">–£–ô–ß–ò</text>
            </g>

            {/* Namangan */}
            <g onClick={() => handleDistrictClick(7)} className="district" data-selected={selectedDistrict === 7}>
            <path d="M771.212 163.02L776.205 185.912L776.212 185.944L776.221 185.976L781.973 205.931H781.974L783.732 212.789L775.286 219.382L775.052 219.565L774.956 219.847L772.457 227.158L771.601 228.162H763.834L763.539 228.623L762.259 230.621L761.943 231.115L762.219 231.632L765.203 237.223L763.546 241.533L761.242 243.331L758.844 244.829L756.293 241.643L753.79 235.29L753.69 235.036L753.475 234.869L750.275 232.371L749.752 231.963L749.172 232.286L745.179 234.511L741.186 232.286L740.811 232.076L740.401 232.204L737.2 233.204L736.734 233.349L736.563 233.806L733.361 242.299L733.359 242.308L733.356 242.316L730.308 250.877L727.423 252.004L725.681 250.644L725.056 231.628L725.01 230.215L723.693 230.729L720.027 232.159H716.53L710.274 230.206L709.448 229.948L709.073 230.728L705.653 237.845L702.215 236.311L699.138 233.429L698.939 233.241L698.672 233.183L694.192 232.183L693.955 232.131L693.722 232.192L689.881 233.191L689.133 233.385V242.262L686.195 245.473L686.114 245.562L686.056 245.667L684.281 248.898L681.112 250.547L674.491 247.963V234.516L685.722 220.881L706.773 203.455L706.783 203.446L713.823 197.451L713.919 197.369L713.992 197.267L724.1 182.967L734.78 177.083L734.909 177.012L735.012 176.906L743.183 168.567L763.153 160.773L771.212 163.02Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="500" y="385" textAnchor="middle" fontSize="12" fontWeight="bold" fill="black">–ù–ê–ú–ê–ù–ì–ê–ù</text>
            </g>

            {/* Norin */}
            <g onClick={() => handleDistrictClick(8)} className="district" data-selected={selectedDistrict === 8}>
              <path d="M711.063 231.871C711.641 230.773 712.976 230.317 714.106 230.831C714.489 231.005 714.896 231.124 715.313 231.182L720.49 231.896C721.745 232.07 723.023 231.882 724.175 231.357L725.41 230.795C725.579 230.718 725.77 230.701 725.949 230.746C726.312 230.838 726.567 231.164 726.567 231.538V247.094C726.567 248.083 726.927 249.039 727.579 249.782L727.808 250.042C729.089 251.501 731.281 251.722 732.828 250.548C733.408 250.107 733.846 249.506 734.085 248.818L738.635 235.768C739.225 234.077 740.689 232.841 742.455 232.543L743.329 232.395C744.108 232.264 744.907 232.46 745.536 232.937C747.058 234.093 749.116 234.251 750.795 233.34L750.925 233.268C751.993 232.69 753.301 232.79 754.268 233.524L754.609 233.783C755.062 234.127 755.431 234.57 755.688 235.077L757.95 239.543C758.375 240.381 758.948 241.135 759.643 241.767C760.935 242.945 761.621 244.647 761.506 246.391L761.184 251.298C761.109 252.441 760.815 253.56 760.32 254.594L758.5 258.394L758.492 258.409L758.486 258.425L755.978 264.139C755.331 265.612 755.567 267.324 756.59 268.566C757.376 269.521 757.252 270.928 756.313 271.731L749.917 277.194C748.866 278.093 747.62 278.737 746.28 279.076L739.816 280.712C739.34 280.832 738.835 280.729 738.444 280.432L737.535 279.742C737.258 279.531 737.224 279.126 737.463 278.872C738.903 277.341 738.014 274.823 735.932 274.536L732.148 274.014C731.926 273.983 731.708 273.924 731.502 273.837L730.827 273.552C727.49 272.144 723.655 272.626 720.77 274.816L720.329 275.15L715.451 278.854C714.051 279.918 712.09 279.83 710.789 278.645L709.098 277.104C707.546 275.691 705.114 275.918 703.851 277.596C703.493 278.072 702.894 278.303 702.309 278.192L694.901 276.786C693.926 276.601 692.988 276.256 692.126 275.765L690.568 274.878C688.909 273.933 687.034 273.436 685.125 273.436H680.386C678.873 273.436 677.385 273.055 676.059 272.328L666.399 267.031L664.89 266.077C663.13 264.964 661.091 264.373 659.009 264.373H651.244L651.194 264.378L641.245 265.385L627.523 266.744C626.408 266.854 625.316 267.134 624.286 267.574L616.305 270.982C615.406 271.366 614.569 271.882 613.823 272.512L611.565 274.417C610.292 275.491 608.47 275.616 607.063 274.725C606.272 274.225 605.373 273.923 604.441 273.845L600.361 273.5C600.045 273.473 599.74 273.374 599.469 273.21L598.826 272.819C598.185 272.429 597.996 271.585 598.408 270.958L598.435 270.917L598.457 270.874L598.494 270.804C599.114 269.627 600.335 268.891 601.665 268.891C602.634 268.89 603.586 268.638 604.428 268.159L606.027 267.249L606.084 267.216L606.136 267.176C606.904 266.592 607.783 266.17 608.718 265.933L610.839 265.396C612.456 264.987 613.958 264.216 615.233 263.141L617.245 261.442C618.536 260.353 620.108 259.65 621.781 259.412L627.664 258.574C629.034 258.379 630.355 257.928 631.557 257.243L634.055 255.82C634.711 255.447 635.43 255.197 636.177 255.084L639.072 254.644C640.948 254.359 642.41 252.868 642.657 250.986C642.796 249.932 643.652 249.117 644.711 249.027L646.138 248.907C647.623 248.782 649.009 248.112 650.031 247.026L650.898 246.104C651.552 245.409 652.335 244.849 653.203 244.453L655.026 243.623L655.038 243.617L655.051 243.61L674.171 234.244V242.668C674.171 245.234 675.615 247.583 677.905 248.742C679.942 249.773 682.362 249.714 684.347 248.584L685.198 248.099C686.49 247.363 687.57 246.306 688.333 245.031L689.674 242.793C690.366 241.636 690.824 240.354 691.019 239.02L691.431 236.202C691.743 234.072 693.481 232.436 695.626 232.255C696.442 232.186 697.263 232.335 698.003 232.686L703.354 235.225C706.01 236.486 709.189 235.428 710.56 232.826L711.063 231.871Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="825" y="240" textAnchor="middle" fontSize="14" fontWeight="bold" fill="black">–ù–û–†–ò–ù</text>
            </g>

            {/* Mingbuloq */}
            <g onClick={() => handleDistrictClick(9)} className="district" data-selected={selectedDistrict === 9}>
              <path d="M469.654 179.68C470.269 179.493 470.937 179.643 471.415 180.073L480.563 188.321C480.782 188.519 481.016 188.699 481.262 188.862L484.915 191.29C485.614 191.755 486.15 192.427 486.445 193.213L486.958 194.573C487.088 194.92 487.17 195.284 487.2 195.653L487.803 202.966V205.886C487.803 207.831 488.746 209.656 490.334 210.781L498.137 216.311L503.135 220.58C503.28 220.704 503.417 220.839 503.543 220.982L509.622 227.906C509.79 228.098 509.94 228.305 510.068 228.524L512.479 232.644L512.493 232.666L512.508 232.688L516.326 238.486C516.756 239.139 516.985 239.905 516.985 240.687V242.148C516.985 244.051 515.644 245.691 513.779 246.068L510.739 246.685C508.585 247.121 507.037 249.014 507.037 251.212C507.037 251.937 506.736 252.631 506.206 253.126L500.318 258.628C499.104 259.763 498.415 261.35 498.415 263.012V266.072C498.415 267.482 498.911 268.846 499.816 269.926L503.047 273.781C503.176 273.936 503.294 274.1 503.399 274.272L506.221 278.913C506.717 279.73 506.904 280.698 506.749 281.641L505.637 288.397C505.36 290.075 504.054 291.395 502.38 291.688L498.193 292.422C497.696 292.509 497.187 292.501 496.692 292.398L490.834 291.186C490.434 291.103 490.026 291.061 489.617 291.061H484.002C482.745 291.06 481.561 290.47 480.806 289.466L480.522 289.09C479.841 288.185 478.917 287.49 477.858 287.088L475.172 286.068C474.175 285.69 473.095 285.584 472.044 285.762L469.301 286.225C468.328 286.389 467.329 286.187 466.496 285.66L465.097 284.774C464.337 284.294 463.478 283.99 462.585 283.886L456.478 283.173C455.392 283.046 454.291 283.218 453.295 283.672L446.267 286.873C445.413 287.262 444.45 287.339 443.545 287.089L438 285.558L437.954 285.545L437.906 285.537L429.752 284.108C429.503 284.065 429.259 283.997 429.022 283.907L425.587 282.604C424.471 282.18 423.255 282.099 422.093 282.37L415.418 283.93C415.172 283.987 414.922 284.021 414.67 284.031L402.267 284.535L405.898 284.087C406.523 284.01 407.133 283.834 407.703 283.567L414.478 280.402C415.368 279.987 416.142 279.359 416.732 278.574L421.289 272.521L421.316 272.484L421.34 272.445L426.015 264.903C426.346 264.368 426.8 263.919 427.338 263.592L432.076 260.714C432.536 260.435 433.047 260.251 433.58 260.174L445.49 258.451C446.289 258.336 447.056 258.061 447.746 257.642L448.383 257.255C449.771 256.411 450.754 255.036 451.102 253.449L451.24 252.821C451.77 250.41 450.517 247.96 448.252 246.978C447.52 246.66 446.936 246.077 446.615 245.347L446.367 244.782C446.145 244.275 446.029 243.727 446.029 243.174V232.912C446.029 232.567 446.113 232.226 446.274 231.92C446.673 231.164 447.485 230.719 448.337 230.791L451.561 231.062C451.816 231.084 452.06 231.178 452.264 231.333C453.863 232.547 456.164 232.09 457.179 230.357L458.148 228.701C458.433 228.214 458.635 227.683 458.744 227.129L462.512 208.063C462.554 207.848 462.614 207.635 462.691 207.43L466.307 197.823C466.481 197.36 466.598 196.876 466.653 196.384L468.364 181.229C468.446 180.502 468.954 179.892 469.654 179.68Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="675" y="415" textAnchor="middle" fontSize="11" fontWeight="bold" fill="black">–ú–ò–ù–ì–ë–£–õ–û“ö</text>
            </g>

            {/* To'raqo'rg'on */}
            <g onClick={() => handleDistrictClick(10)} className="district" data-selected={selectedDistrict === 10}>
              <path d="M572.523 215.827L581.07 216.109C582.724 216.163 584.175 217.232 584.717 218.796L586.632 224.323C586.778 224.744 586.853 225.186 586.853 225.632V249.037C586.853 250.533 587.411 251.975 588.419 253.08L597.565 263.11C598.702 264.356 600.311 265.068 601.998 265.068H604.942C605.417 265.068 605.842 265.362 606.009 265.806C606.241 266.423 605.904 267.108 605.274 267.299L601.816 268.349C600.927 268.619 600.184 269.233 599.751 270.054L599.277 270.955C598.853 271.76 598.999 272.745 599.638 273.392C599.656 273.411 599.661 273.424 599.662 273.431C599.665 273.442 599.664 273.458 599.658 273.477C599.652 273.496 599.643 273.51 599.635 273.518C599.629 273.523 599.619 273.531 599.594 273.536L596.74 274.078C596.328 274.156 595.932 274.305 595.571 274.518L589.997 277.809L589.978 277.821L584.783 281.048C583.724 281.706 582.419 281.832 581.253 281.39L578.351 280.288C576.309 279.513 574.003 280.259 572.802 282.083C572.622 282.357 572.393 282.595 572.126 282.786L563.365 289.045C562.375 289.753 561.116 289.971 559.945 289.638L556.955 288.786L556.902 288.772L556.847 288.762L551.291 287.825C550.962 287.769 550.628 287.742 550.293 287.742H545.359L545.312 287.745L535.251 288.701C534.958 288.728 534.662 288.724 534.37 288.687L527.796 287.855C527.133 287.771 526.459 287.799 525.805 287.937L515.978 290.009C515.303 290.151 514.603 290.117 513.946 289.91L511.088 289.005C509.292 288.437 508.135 286.692 508.312 284.817L508.476 283.077C508.571 282.061 508.407 281.036 507.996 280.102L506.754 277.273C506.574 276.862 506.348 276.473 506.081 276.113L501.083 269.368C500.747 268.914 500.511 268.394 500.39 267.843L500.073 266.397C500.011 266.115 499.98 265.828 499.98 265.539V262.377C499.98 261.192 500.505 260.067 501.415 259.307L505.553 255.852C506.109 255.388 506.576 254.827 506.932 254.197L508.473 251.466L509.452 249.73C509.97 248.813 510.829 248.137 511.841 247.849L514.109 247.203C514.971 246.958 515.755 246.494 516.385 245.856C517.347 244.882 517.887 243.568 517.887 242.199V241.191C517.887 240.173 517.628 239.171 517.134 238.281L512.656 230.206C512.607 230.117 512.581 230.017 512.581 229.915C512.581 229.584 512.85 229.315 513.181 229.315H515.941C516.707 229.315 517.465 229.15 518.162 228.832L518.899 228.497C519.785 228.094 520.788 228.027 521.72 228.31L522.104 228.426C522.992 228.696 523.93 228.756 524.845 228.602L526.993 228.24C528.987 227.903 530.677 226.586 531.49 224.735L532.686 222.01C532.882 221.563 533.159 221.155 533.502 220.807L535.845 218.436C536.931 217.336 538.755 217.516 539.606 218.807C539.882 219.226 540.227 219.595 540.626 219.899L544.788 223.059L550.417 227.661C552.524 229.384 555.526 229.473 557.731 227.878L567.369 220.91C568.309 220.23 568.997 219.256 569.323 218.143C569.736 216.731 571.052 215.778 572.523 215.827Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

              <text x="825" y="425" textAnchor="middle" fontSize="11" fontWeight="bold" fill="black">–¢–é–†–ê“ö–é–†“í–û–ù</text>
            </g>

            <g onClick={() => handleDistrictClick(11)} className="district" data-selected={selectedDistrict === 11}>
<path d="M425.339 282.617C425.795 282.567 426.257 282.607 426.698 282.736L441.68 287.112C442.793 287.437 443.973 287.458 445.097 287.174L455.111 284.639C455.391 284.568 455.68 284.533 455.97 284.533H463.638C464.097 284.533 464.552 284.623 464.977 284.799L469.822 286.805C471.115 287.341 472.547 287.445 473.904 287.101L475.776 286.627C476.869 286.35 478.03 286.617 478.892 287.344L481.748 289.756C482.723 290.578 483.919 291.095 485.186 291.243L498.801 292.834C500.573 293.041 502.352 292.509 503.721 291.366L506.656 288.915C507.552 288.167 508.761 287.914 509.881 288.241L515.106 289.767C515.826 289.978 516.578 290.062 517.327 290.015L540.897 288.564L560.587 290.059C561.19 290.192 561.326 291.005 560.781 291.321L555.319 294.493C555.065 294.64 554.79 294.749 554.504 294.816L546.971 296.576C546.591 296.665 546.22 296.787 545.863 296.942L536.99 300.792L536.964 300.802L536.939 300.815L526.839 305.658C524.687 306.69 524.493 309.678 526.493 310.98C526.505 310.988 526.511 310.994 526.512 310.996C526.513 310.998 526.514 310.999 526.515 311.001C526.517 311.005 526.521 311.017 526.52 311.034C526.519 311.051 526.514 311.062 526.511 311.066C526.51 311.068 526.509 311.069 526.507 311.071C526.505 311.073 526.499 311.078 526.487 311.084L512.659 317.764C508.933 319.565 507.816 324.343 510.358 327.609L515.132 333.744L516.821 336.468C518.063 338.472 517.007 341.106 514.725 341.699L496.09 346.539L496.029 346.555L495.968 346.576L477.398 353.123L477.335 353.144L477.275 353.172L451.733 364.807C451.277 365.015 450.783 365.123 450.282 365.123H441.541C440.311 365.123 439.105 365.472 438.066 366.13L435.381 367.827L416.211 377.365L416.116 377.412L416.029 377.471L396.823 390.686C395.932 391.299 394.808 391.466 393.778 391.138L375.975 385.47C375.777 385.408 375.586 385.327 375.403 385.23L361.289 377.776C360.646 377.436 359.949 377.207 359.23 377.097L354.024 376.307C353.75 376.266 353.481 376.192 353.225 376.087L345.563 372.954C345.468 372.915 345.375 372.872 345.283 372.825L345.016 372.673L337.78 368.094C337.477 367.902 337.16 367.736 336.83 367.597L326.204 363.116C325.405 362.779 324.546 362.604 323.678 362.604H312.448C312.28 362.604 312.113 362.592 311.948 362.568L303.204 361.304C301.951 361.123 301.28 359.729 301.92 358.636C301.988 358.521 302.069 358.413 302.16 358.315L308.538 351.537L308.597 351.473L308.649 351.404L317.271 339.823L317.308 339.773L317.34 339.72L328.781 321.384C329.208 320.698 329.504 319.939 329.654 319.145L330.416 315.093C330.591 314.165 331.133 313.346 331.919 312.824L333.961 311.468C334.643 311.015 335.462 310.816 336.276 310.904L351.143 312.516C352.736 312.689 354.338 312.267 355.639 311.331L365.592 304.173C366.094 303.812 366.682 303.59 367.297 303.53L390.706 301.252C391.661 301.159 392.583 300.855 393.406 300.364L400.546 296.105C401.088 295.782 401.709 295.611 402.34 295.611H404.807C408.854 295.611 411.757 291.711 410.597 287.834C410.051 286.011 411.293 284.14 413.185 283.935L425.339 282.617Z" fill="#38D9A0" stroke="white" stroke-width="3"/>

            <text x="825" y="425" textAnchor="middle" fontSize="11" fontWeight="bold" fill="black">–¢–é–†–ê“ö–é–†“í–û–ù</text>
            </g>

            <g onClick={() => handleDistrictClick(12)} className="district" data-selected={selectedDistrict === 12}>
            <path d="M577.219 211.058L577.3 211.071H599.122L602.362 218.691L604.09 227.328V236.629H591.074L577.643 233.024L577.451 232.972L577.255 232.997L553.086 236.117L553.044 236.122L553.002 236.132L524.317 242.327L511.335 239.839L505.709 232.396L500.251 223.25L509.429 214.679L527.948 213.148L528.057 213.139L528.162 213.106L537.439 210.219C537.885 210.08 538.342 209.975 538.805 209.907L555.562 207.443L577.219 211.058Z" fill="#38D9A0" stroke="white" stroke-width="2"/>

            <text x="825" y="425" textAnchor="middle" fontSize="11" fontWeight="bold" fill="black">–¢–é–†–ê“ö–é–†“í–û–ù</text>
            </g>

          </svg>
        </div>
      )}

      {/* Statistika */}
      <div className="dashboard__stats">
        <div className="stat-card">
          <div className="stat-icon">üë•</div>
          <div className="stat-info">
            <div className="stat-label">Shaxslar:</div>
            <div className="stat-value">{overallStats.total}</div>
          </div>
        </div>

        <div className="stat-card">
          <div className="stat-icon">‚ö†Ô∏è</div>
          <div className="stat-info">
            <div className="stat-label">Ishlovdagi shaxslar:</div>
            <div className="stat-value">{overallStats.inProcess}</div>
          </div>
        </div>
      </div>

      {/* Hisobot yuklash tugmasi */}
      <button className="dashboard__btn" onClick={() => navigate('/reports')}>
        üì• Hisobot Yuklash
      </button>

      {/* Tanlangan tuman statistikasi */}
      {selectedDistrict && districtStats[selectedDistrict] && (
        <div className="district-details">
          <h3>{districtStats[selectedDistrict].name}</h3>
          <div className="district-stats">
            <div className="district-stat">
              <span className="label">Jami shaxslar:</span>
              <span className="value">{districtStats[selectedDistrict].total}</span>
            </div>
            <div className="district-stat">
              <span className="label">Ishlovda:</span>
              <span className="value">{districtStats[selectedDistrict].inProcess}</span>
            </div>
          </div>

          {/* Tanlangan tuman shaxslari ro'yxati */}
          {filteredPersons.length > 0 && (
            <div className="persons-list">
              <h4>Shaxslar ro'yxati:</h4>
              <table className="persons-table">
                <thead>
                  <tr>
                    <th>‚Ññ</th>
                    <th>F.I.O</th>
                    <th>Pasport</th>
                    <th>Mahalla</th>
                    <th>Ishlovda</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredPersons.map((person, index) => (
                    <tr
                      key={person.id}
                      onClick={() => navigate(`/person/${person.id}`)}
                      className="clickable-row"
                    >
                      <td>{index + 1}</td>
                      <td>{person.lastName} {person.firstName}</td>
                      <td>{person.passportSerial} {person.passportNumber}</td>
                      <td>{person.mahallaName}</td>
                      <td>
                        {person.inProcess ? (
                          <span className="badge badge-yes">Ha</span>
                        ) : (
                          <span className="badge badge-no">Yo'q</span>
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      )}

      {/* Oxirgi qo'shilgan shaxslar */}
      {!selectedDistrict && (
        <div className="dashboard__list">
          <h3>Oxirgi qo'shilgan shaxslar</h3>
          {allPersons.length === 0 ? (
            <p className="empty-text">Hozircha ma'lumot yo'q</p>
          ) : (
            <table className="persons-table">
              <thead>
                <tr>
                  <th>‚Ññ</th>
                  <th>F.I.O</th>
                  <th>Tuman</th>
                  <th>Mahalla</th>
                  <th>Ro'yxatga olingan vaqt</th>
                  <th>Ishlovda</th>
                </tr>
              </thead>
              <tbody>
                {allPersons.slice(0, 10).map((person, index) => (
                  <tr
                    key={person.id}
                    onClick={() => navigate(`/person/${person.id}`)}
                    className="clickable-row"
                  >
                    <td>{index + 1}</td>
                    <td>{person.lastName} {person.firstName}</td>
                    <td>{person.districtName}</td>
                    <td>{person.mahallaName}</td>
                    <td>{new Date(person.registeredAt).toLocaleString('uz-UZ')}</td>
                    <td>
                      {person.inProcess ? (
                        <span className="badge badge-yes">Ha</span>
                      ) : (
                        <span className="badge badge-no">Yo'q</span>
                      )}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          )}
        </div>
      )}
    </div>
  );
}

